function Banner(){}Banner.prototype.LoadData=function(){var a=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(200===n.code){var e=n.data;for(console.log(e),i=0;i<e.length;i++){var t=e[i];a.CreateBannerEvent(t)}}}})},Banner.prototype.CreateBannerEvent=function(n){var e=this,t=template("banner-item",{banner:n}),a=$(".banner-list-group"),i=null;n?(a.append(t),i=a.find(".banner-item:last")):(a.prepend(t),i=a.find(".banner-item:first")),e.ListernImgClickEvent(i),e.RemoveBannerEvent(i),e.addBannerBtnClickEvent(i)},Banner.prototype.ListenAddBtnClickEvent=function(){var e=this;$(".add-btn").click(function(){var n=$(".banner-list-group").children().length;console.log(n),console.log("................."),6<=n?window.messageBox.showInfo("最多只能添加6张轮播图！"):e.CreateBannerEvent()})},Banner.prototype.ListernImgClickEvent=function(n){var t=n.find(".thumbnail"),e=n.find(".image-input");t.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;t.attr("src",e)}}})})},Banner.prototype.addBannerBtnClickEvent=function(a){var i=a.find("span[class='priority']"),o=a.find("input[name='priority']"),r=a.find(".thumbnail"),c=a.find("input[name='link_to']"),n=a.find(".save-btn"),s=a.attr("data-banner-id"),l="";l=s?"/cms/editbanner/":"/cms/addbanner/",n.click(function(){var e=o.val(),n=c.val(),t=r.attr("src");xfzajax.post({url:l,data:{priority:e,image_url:t,link_to:n,pk:s},success:function(n){200===n.code?(s?window.messageBox.showSuccess("修改成功！"):(s=n.data.banner_id,a.attr("data-banner-id",s),window.messageBox.showSuccess("添加成功！")),i.text("优先级："+e)):console.log(n.message)},fail:function(n){console.log(n)}})})},Banner.prototype.RemoveBannerEvent=function(e){e.find(".close-btn").click(function(){var n=e.attr("data-banner-id");n?xtalert.alertConfirm({msg:"确认删除此轮播图？",confirmCallback:function(){xfzajax.post({url:"/cms/delete_banner/",data:{banner_id:n},success:function(n){200===n.code&&(e.remove(),window.messageBox.showSuccess("删除成功！"))}})}}):e.remove()})},Banner.prototype.run=function(){this.ListenAddBtnClickEvent(),this.LoadData()},$(function(){(new Banner).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lci5qcyJdLCJuYW1lcyI6WyJCYW5uZXIiLCJwcm90b3R5cGUiLCJMb2FkRGF0YSIsInNlbGYiLCJ0aGlzIiwieGZ6YWpheCIsImdldCIsInVybCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJiYW5uZXJzIiwiY29uc29sZSIsImxvZyIsImkiLCJsZW5ndGgiLCJiYW5uZXIiLCJDcmVhdGVCYW5uZXJFdmVudCIsInRwbCIsInRlbXBsYXRlIiwiYmFubmVyTGlzdCIsIiQiLCJiYW5uZXJJdGVtIiwiYXBwZW5kIiwiZmluZCIsInByZXBlbmQiLCJMaXN0ZXJuSW1nQ2xpY2tFdmVudCIsIlJlbW92ZUJhbm5lckV2ZW50IiwiYWRkQmFubmVyQnRuQ2xpY2tFdmVudCIsIkxpc3RlbkFkZEJ0bkNsaWNrRXZlbnQiLCJjbGljayIsImNoaWxkcmVuIiwid2luZG93IiwibWVzc2FnZUJveCIsInNob3dJbmZvIiwiaW1hZ2UiLCJpbWFnZUlucHV0IiwiY2hhbmdlIiwiZmlsZSIsImZpbGVzIiwiZm9ybWRhdGEiLCJGb3JtRGF0YSIsInBvc3QiLCJkYXRhIiwicHJvY2Vzc0RhdGEiLCJjb250ZW50VHlwZSIsImltZ3VybCIsImF0dHIiLCJwcmlvcml0eVNwYW4iLCJwcmlvcml0eVRhZyIsImltYWdlVGFnIiwibGlua190b1RhZyIsInNhdmVCdG4iLCJiYW5uZXJJZCIsInByaW9yaXR5IiwidmFsIiwibGlua190byIsImltYWdlX3VybCIsInBrIiwic2hvd1N1Y2Nlc3MiLCJ0ZXh0IiwiZmFpbCIsImVyciIsInh0YWxlcnQiLCJhbGVydENvbmZpcm0iLCJtc2ciLCJjb25maXJtQ2FsbGJhY2siLCJiYW5uZXJfaWQiLCJyZW1vdmUiLCJydW4iXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLFVBR1RBLE9BQU9DLFVBQVVDLFNBQVcsV0FDeEIsSUFBSUMsRUFBT0MsS0FDWEMsUUFBUUMsSUFBSSxDQUNSQyxJQUFNLG9CQUNOQyxRQUFVLFNBQVVDLEdBQ2hCLEdBQXNCLE1BQW5C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S0FBSyxDQUNUbEMsSUFBTyxzQkFDUG1DLEtBQVEsQ0FDSndCLFVBQWFkLEdBRWpCNUMsUUFBVyxTQUFVQyxHQUNNLE1BQW5CQSxFQUFhLE9BQ2JZLEVBQVc4QyxTQUNYcEMsT0FBT0MsV0FBVzBCLFlBQVksZ0JBT2xEckMsRUFBVzhDLFlBSXZCbkUsT0FBT0MsVUFBVW1FLElBQU0sV0FDbkJoRSxLQUFLd0IseUJBQ0x4QixLQUFLRixZQUVUa0IsRUFBRSxZQUNlLElBQUlwQixRQUNWb0UiLCJmaWxlIjoiYmFubmVyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIEJhbm5lcigpIHtcclxuXHJcbn1cclxuQmFubmVyLnByb3RvdHlwZS5Mb2FkRGF0YSA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgJ3VybCc6Jy9jbXMvYmFubmVyX2xpc3QvJyxcclxuICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKXtcclxuICAgICAgICAgICAgICAgICB2YXIgYmFubmVycyA9IHJlc3VsdFsnZGF0YSddO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYmFubmVycyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGk9MDtpPGJhbm5lcnMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhbm5lciA9IGJhbm5lcnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5DcmVhdGVCYW5uZXJFdmVudChiYW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufTtcclxuQmFubmVyLnByb3RvdHlwZS5DcmVhdGVCYW5uZXJFdmVudCA9IGZ1bmN0aW9uKGJhbm5lcil7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdHBsID0gdGVtcGxhdGUoJ2Jhbm5lci1pdGVtJyx7J2Jhbm5lcic6YmFubmVyfSk7XHJcbiAgICB2YXIgYmFubmVyTGlzdCA9ICQoJy5iYW5uZXItbGlzdC1ncm91cCcpO1xyXG4gICAgdmFyIGJhbm5lckl0ZW0gPSBudWxsO1xyXG4gICAgaWYoYmFubmVyKXtcclxuICAgICAgICBiYW5uZXJMaXN0LmFwcGVuZCh0cGwpO1xyXG4gICAgICAgIGJhbm5lckl0ZW0gPSBiYW5uZXJMaXN0LmZpbmQoJy5iYW5uZXItaXRlbTpsYXN0Jyk7XHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgICAgYmFubmVyTGlzdC5wcmVwZW5kKHRwbCk7XHJcbiAgICAgICAgYmFubmVySXRlbSA9IGJhbm5lckxpc3QuZmluZCgnLmJhbm5lci1pdGVtOmZpcnN0Jyk7XHJcbiAgICB9XHJcbiAgICBzZWxmLkxpc3Rlcm5JbWdDbGlja0V2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgc2VsZi5SZW1vdmVCYW5uZXJFdmVudChiYW5uZXJJdGVtKTtcclxuICAgIHNlbGYuYWRkQmFubmVyQnRuQ2xpY2tFdmVudChiYW5uZXJJdGVtKTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUuTGlzdGVuQWRkQnRuQ2xpY2tFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgYWRkQnRuID0gJCgnLmFkZC1idG4nKTtcclxuICAgIGFkZEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGJhbm5lckxpc3RHcm91cCA9ICQoJy5iYW5uZXItbGlzdC1ncm91cCcpO1xyXG4gICAgICAgIHZhciBsZW5ndGggPSBiYW5uZXJMaXN0R3JvdXAuY2hpbGRyZW4oKS5sZW5ndGg7XHJcbiAgICAgICAgY29uc29sZS5sb2cobGVuZ3RoKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnLi4uLi4uLi4uLi4uLi4uLi4nKTtcclxuICAgICAgICBpZiAobGVuZ3RoID49IDYpIHtcclxuICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0luZm8oJ+acgOWkmuWPquiDvea3u+WKoDblvKDova7mkq3lm77vvIEnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLkNyZWF0ZUJhbm5lckV2ZW50KCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUuTGlzdGVybkltZ0NsaWNrRXZlbnQgPSBmdW5jdGlvbihiYW5uZXJJdGVtKXtcclxuICAgIHZhciBpbWFnZSA9IGJhbm5lckl0ZW0uZmluZCgnLnRodW1ibmFpbCcpO1xyXG4gICAgdmFyIGltYWdlSW5wdXQgPSBiYW5uZXJJdGVtLmZpbmQoJy5pbWFnZS1pbnB1dCcpO1xyXG4gICAgaW1hZ2UuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIHZhciB0aGF0ID0gJCh0aGlzKTtcclxuICAgICAgICAvLyB2YXIgaW1hZ2VJbnB1dCA9IHRoYXQuc2libGluZ3MoJy5pbWFnZS1pbnB1dCcpO1xyXG4gICAgICAgIGltYWdlSW5wdXQuY2xpY2soKTtcclxuICAgIH0pO1xyXG4gICAgaW1hZ2VJbnB1dC5jaGFuZ2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXTtcclxuICAgICAgICB2YXIgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICBmb3JtZGF0YS5hcHBlbmQoJ2ZpbGUnLGZpbGUpO1xyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOicvY21zL3VwbG9hZF9maWxlLycsXHJcbiAgICAgICAgICAgICdkYXRhJzpmb3JtZGF0YSxcclxuICAgICAgICAgICAgJ3Byb2Nlc3NEYXRhJzpmYWxzZSxcclxuICAgICAgICAgICAgJ2NvbnRlbnRUeXBlJzpmYWxzZSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1ndXJsID0gcmVzdWx0WydkYXRhJ11bJ3VybCddO1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlLmF0dHIoJ3NyYycsaW1ndXJsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG5CYW5uZXIucHJvdG90eXBlLmFkZEJhbm5lckJ0bkNsaWNrRXZlbnQgPSBmdW5jdGlvbihiYW5uZXJJdGVtKXtcclxuICAgIHZhciBwcmlvcml0eVNwYW4gPSBiYW5uZXJJdGVtLmZpbmQoXCJzcGFuW2NsYXNzPSdwcmlvcml0eSddXCIpO1xyXG4gICAgdmFyIHByaW9yaXR5VGFnID0gYmFubmVySXRlbS5maW5kKFwiaW5wdXRbbmFtZT0ncHJpb3JpdHknXVwiKTtcclxuICAgIHZhciBpbWFnZVRhZyA9IGJhbm5lckl0ZW0uZmluZCgnLnRodW1ibmFpbCcpO1xyXG4gICAgdmFyIGxpbmtfdG9UYWcgPSBiYW5uZXJJdGVtLmZpbmQoXCJpbnB1dFtuYW1lPSdsaW5rX3RvJ11cIik7XHJcbiAgICB2YXIgc2F2ZUJ0biA9IGJhbm5lckl0ZW0uZmluZCgnLnNhdmUtYnRuJyk7XHJcbiAgICB2YXIgYmFubmVySWQgPSBiYW5uZXJJdGVtLmF0dHIoJ2RhdGEtYmFubmVyLWlkJyk7XHJcbiAgICB2YXIgdXJsID0gJyc7XHJcbiAgICBpZiAoYmFubmVySWQpIHtcclxuICAgICAgICB1cmwgPSAnL2Ntcy9lZGl0YmFubmVyLyc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHVybCA9ICcvY21zL2FkZGJhbm5lci8nO1xyXG4gICAgfVxyXG4gICAgc2F2ZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHByaW9yaXR5ID0gcHJpb3JpdHlUYWcudmFsKCk7XHJcbiAgICAgICAgdmFyIGxpbmtfdG8gPSBsaW5rX3RvVGFnLnZhbCgpO1xyXG4gICAgICAgIHZhciBpbWFnZV91cmwgPSBpbWFnZVRhZy5hdHRyKCdzcmMnKTtcclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogdXJsLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICdwcmlvcml0eSc6IHByaW9yaXR5LFxyXG4gICAgICAgICAgICAgICAgJ2ltYWdlX3VybCc6IGltYWdlX3VybCxcclxuICAgICAgICAgICAgICAgICdsaW5rX3RvJzogbGlua190byxcclxuICAgICAgICAgICAgICAgICdwayc6YmFubmVySWRcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGJhbm5lcklkKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+S/ruaUueaIkOWKn++8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVySWQgPSByZXN1bHRbJ2RhdGEnXVsnYmFubmVyX2lkJ107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lckl0ZW0uYXR0cignZGF0YS1iYW5uZXItaWQnLGJhbm5lcklkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+a3u+WKoOaIkOWKn++8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwcmlvcml0eVNwYW4udGV4dCgn5LyY5YWI57qn77yaJysgcHJpb3JpdHkpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdFsnbWVzc2FnZSddKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6ZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcbkJhbm5lci5wcm90b3R5cGUuUmVtb3ZlQmFubmVyRXZlbnQgPSBmdW5jdGlvbihiYW5uZXJJdGVtKXtcclxuICAgIHZhciBjbG9zZUJ0biA9IGJhbm5lckl0ZW0uZmluZCgnLmNsb3NlLWJ0bicpO1xyXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBiYW5uZXJJZCA9IGJhbm5lckl0ZW0uYXR0cignZGF0YS1iYW5uZXItaWQnKTtcclxuICAgICAgICBpZiAoYmFubmVySWQpIHtcclxuICAgICAgICAgICAgeHRhbGVydC5hbGVydENvbmZpcm0oe1xyXG4gICAgICAgICAgICAgICAgJ21zZyc6ICfnoa7orqTliKDpmaTmraTova7mkq3lm77vvJ8nLFxyXG4gICAgICAgICAgICAgICAgJ2NvbmZpcm1DYWxsYmFjayc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAndXJsJzogJy9jbXMvZGVsZXRlX2Jhbm5lci8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdiYW5uZXJfaWQnOiBiYW5uZXJJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93U3VjY2Vzcygn5Yig6Zmk5oiQ5Yqf77yBJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICBiYW5uZXJJdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn07XHJcbkJhbm5lci5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5MaXN0ZW5BZGRCdG5DbGlja0V2ZW50KCk7XHJcbiAgICB0aGlzLkxvYWREYXRhKCk7XHJcbn07XHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGJhbm5lciA9IG5ldyBCYW5uZXIoKTtcclxuICAgIGJhbm5lci5ydW4oKTtcclxufSk7Il19
