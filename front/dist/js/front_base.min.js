function FrontBase(){}function Auth(){this.scrollWrapper=$(".scroll-wrapper"),this.maskWrapper=$(".mask-wrapper"),this.smsCapthaBtn=$("#sms-captcha")}FrontBase.prototype.run=function(){this.ListenUserBox()},FrontBase.prototype.ListenUserBox=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})},$(function(){(new FrontBase).run()}),Auth.prototype.ShowEvent=function(){this.maskWrapper.show()},Auth.prototype.HideEvent=function(){this.maskWrapper.hide()},Auth.prototype.ListenBtnClick=function(){var t=this,e=$(".signin-btn"),n=$(".signup-btn"),s=$(".close-btn");e.click(function(){t.ShowEvent(),t.scrollWrapper.css({left:0})}),n.click(function(){t.ShowEvent(),t.scrollWrapper.css({left:"-400px"})}),s.click(function(){t.HideEvent()})},Auth.prototype.ListenSigninBtnClick=function(){var o=this,t=$(".signin-group"),e=t.find("input[name='telephone']"),n=t.find("input[name='password']"),s=t.find("input[name='remember']");t.find(".submit-btn").click(function(){telephone=e.val(),password=n.val(),remember=s.prop("checked"),telephone&&password||window.messageBox.showInfo("请输入完整的账号信息！"),xfzajax.post({url:"/account/login/",data:{telephone:telephone,password:password,remember:remember?1:0},success:function(t){if(200==t.code)o.HideEvent(),window.location.reload();else{var e=t.message;if("string"==typeof e||e.constructor==String)window.messageBox.showError(e);else for(var n in console.log(e),e){var s=e[n][0];window.messageBox.showError(s)}}},fail:function(t){window.messageBox.showError(t)}})})},Auth.prototype.ListensignupEvent=function(){var t=$(".signup-group"),r=t.find("input[name='telephone']"),c=t.find("input[name='sms_captcha']"),p=t.find("input[name='img_captcha']"),u=t.find("input[name='username']"),h=t.find("input[name='password1']"),l=t.find("input[name='password2']");t.find(".submit-btn").click(function(t){t.preventDefault();var e=r.val(),n=c.val(),s=p.val(),o=h.val(),a=l.val(),i=u.val();e?i?o?a?n&&s?xfzajax.post({url:"/account/signup/",data:{telephone:e,username:i,password1:o,password2:a,img_captcha:s,sms_captcha:n},success:function(t){if(200==t.code)window.location.reload();else{var e=t.message;if("string"==typeof e||e.constructor==String)window.messageBox.showError(e);else for(var n in console.log(e),e){var s=e[n][0];window.messageBox.showError(s)}}},fail:function(t){window.messageBox.showError(t)}}):window.messageBox.showError("请输入验证码"):window.messageBox.showError("请再次确认密码"):window.messageBox.showError("请输入密码"):window.messageBox.showError("请输入用户名"):window.messageBox.showError("请输入手机号")})},Auth.prototype.Switch=function(){var e=this;$(".switch").click(function(){var t=e.scrollWrapper.css("left");(t=parseInt(t))<0?e.scrollWrapper.animate({left:"0"}):e.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.ListenimgCaptcha=function(){var t=$("#captcha-img");t.click(function(){t.attr("src","/account/img_captcha/?=random"+Math.random())})},Auth.prototype.ListensmsSuccessSend=function(){var t=this;window.messageBox.showSuccess("发送成功，请注意查收"),t.smsCapthaBtn.addClass("disabled");var e=10;t.smsCapthaBtn.unbind("click");var n=setInterval(function(){t.smsCapthaBtn.text(e+"s"),(e-=1)<=0&&(t.smsCapthaBtn.removeClass("disabled"),clearInterval(n),t.smsCapthaBtn.text("发送验证码"),t.ListensmsCaptchaEvent())},1e3)},Auth.prototype.ListensmsCaptchaEvent=function(){var o=this,a=$(".signup-group").find("input[name='telephone']");o.smsCapthaBtn.click(function(t){t.preventDefault();var e=a.val(),n=(new Date).getTime(),s=md5(e+n+"dagfdv!@$%$#^ghgdafdvsafa$@$#");console.log(n),/^1[35789]\d{9}$/.test(e)?xfzajax.post({url:"/account/sms_captcha/",data:{telephone:e,timestamp:n,sign:s},success:function(t){200==t.code?o.ListensmsSuccessSend():window.messageBox.showError(t.message)},fail:function(t){window.messageBox.showError(t)}}):window.messageBox.showError("请输入正确的手机号！")})},Auth.prototype.run=function(){this.ListenBtnClick(),this.Switch(),this.ListenSigninBtnClick(),this.ListenimgCaptcha(),this.ListensmsCaptchaEvent(),this.ListensignupEvent()},$(function(){(new Auth).run()}),$(function(){template.defaults.imports.timesince=function(t){var e=new Date(t),n=e.getTime(),s=((new Date).getTime()-n)/1e3;return s<60?"刚刚":60<s&&s<3600?(minutes=parseInt(s/60),minutes+"分钟前"):3600<s&&s<86400?(hours=parseInt(s/3600),hours+"小时前"):86400<s&&s<2592e3?(days=parseInt(s/86400),days+"天前"):e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()+"/"+e.getHours()+"/"+e.getMinutes()}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInRoaXMiLCJzY3JvbGxXcmFwcGVyIiwiJCIsIm1hc2tXcmFwcGVyIiwic21zQ2FwdGhhQnRuIiwicHJvdG90eXBlIiwicnVuIiwiTGlzdGVuVXNlckJveCIsImF1dGhCb3giLCJ1c2VyTW9yZUJveCIsImhvdmVyIiwic2hvdyIsImhpZGUiLCJTaG93RXZlbnQiLCJIaWRlRXZlbnQiLCJMaXN0ZW5CdG5DbGljayIsInNlbGYiLCJzaWduaW5CdG4iLCJzaWdudXBCdG4iLCJjbG9zZUJ0biIsImNsaWNrIiwiY3NzIiwibGVmdCIsIkxpc3RlblNpZ25pbkJ0bkNsaWNrIiwic2lnbmluR3JvdXAiLCJ0ZWxlcGhvbmVJbnB1dCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsInRlbGVwaG9uZSIsInZhbCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwid2luZG93IiwibWVzc2FnZUJveCIsInNob3dJbmZvIiwieGZ6YWpheCIsInBvc3QiLCJ1cmwiLCJkYXRhIiwic3VjY2VzcyIsInJlc3VsdCIsImxvY2F0aW9uIiwicmVsb2FkIiwibWVzc2FnZU9iamVjdCIsImNvbnN0cnVjdG9yIiwiU3RyaW5nIiwic2hvd0Vycm9yIiwia2V5IiwiY29uc29sZSIsImxvZyIsIm1lc3NhZ2UiLCJmYWlsIiwiZXJyb3IiLCJMaXN0ZW5zaWdudXBFdmVudCIsInNpZ251cEdyb3VwIiwic21zY2FwdGNoYUlucHV0IiwiaW1nY2FwdGNoYUlucHV0IiwidXNlcm5hbWVJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJldmVudCIsInByZXZlbnREZWZhdWx0Iiwic21zX2NhcHRjaGEiLCJpbWdfY2FwdGNoYSIsInBhc3N3b3JkMSIsInBhc3N3b3JkMiIsInVzZXJuYW1lIiwiU3dpdGNoIiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJMaXN0ZW5pbWdDYXB0Y2hhIiwiaW1nQ2FwdGNoYSIsImF0dHIiLCJNYXRoIiwicmFuZG9tIiwiTGlzdGVuc21zU3VjY2Vzc1NlbmQiLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwiY291bnQiLCJ1bmJpbmQiLCJ0aW1lciIsInNldEludGVydmFsIiwidGV4dCIsInJlbW92ZUNsYXNzIiwiY2xlYXJJbnRlcnZhbCIsIkxpc3RlbnNtc0NhcHRjaGFFdmVudCIsInRpbWVzdGFtcCIsIkRhdGUiLCJnZXRUaW1lIiwic2lnbiIsIm1kNSIsInRlc3QiLCJ0ZW1wbGF0ZSIsImRlZmF1bHRzIiwiaW1wb3J0cyIsInRpbWVzaW5jZSIsInZhbHVlRGF0ZSIsImRhdGUiLCJkYXRlcyIsIm1pbnV0ZXMiLCJob3VycyIsImRheXMiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF5IiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIl0sIm1hcHBpbmdzIjoiQUFFQSxTQUFTQSxhQTJCVCxTQUFTQyxPQUNMQyxLQUFLQyxjQUFnQkMsRUFBRSxtQkFDdkJGLEtBQUtHLFlBQWNELEVBQUUsaUJBQ3JCRixLQUFLSSxhQUFlRixFQUFFLGdCQTNCMUJKLFVBQVVPLFVBQVVDLElBQU0sV0FDWE4sS0FDTk8saUJBR1RULFVBQVVPLFVBQVVFLGNBQWdCLFdBQ2xDLElBQUlDLEVBQVNOLEVBQUUsYUFDWE8sRUFBY1AsRUFBRSxrQkFDcEJNLEVBQVFFLE1BQU0sV0FDVkQsRUFBWUUsUUFDZCxXQUNFRixFQUFZRyxVQUlsQlYsRUFBRSxZQUNpQixJQUFJSixXQUNWUSxRQWNiUCxLQUFLTSxVQUFVUSxVQUFZLFdBQ1piLEtBQ05HLFlBQVlRLFFBR3JCWixLQUFLTSxVQUFVUyxVQUFZLFdBQ1pkLEtBQ05HLFlBQVlTLFFBR3JCYixLQUFLTSxVQUFVVSxlQUFpQixXQUM1QixJQUFJQyxFQUFPaEIsS0FDUGlCLEVBQVlmLEVBQUUsZUFDZGdCLEVBQVloQixFQUFFLGVBQ2RpQixFQUFXakIsRUFBRSxjQUNqQmUsRUFBVUcsTUFBTSxX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LEVBQ2I0RCxVQUFZQSxFQUNaRyxLQUFPQSxHQUVYbkQsUUFBVyxTQUFVQyxHQUNLLEtBQWxCQSxFQUFhLEtBQ2IxQixFQUFLOEQsdUJBRUw1QyxPQUFPQyxXQUFXYSxVQUFVTixFQUFnQixVQUdwRFcsS0FBUSxTQUFVQyxHQUNkcEIsT0FBT0MsV0FBV2EsVUFBVU0sTUFsQmhDcEIsT0FBT0MsV0FBV2EsVUFBVSxpQkF3QnhDakQsS0FBS00sVUFBVUMsSUFBTSxXQUNqQk4sS0FBS2UsaUJBQ0xmLEtBQUtxRSxTQUNMckUsS0FBS3VCLHVCQUNMdkIsS0FBS3lFLG1CQUNMekUsS0FBS3dGLHdCQUNMeEYsS0FBS3VELHFCQUdUckQsRUFBRSxZQUNhLElBQUlILE1BQ1ZPLFFBRVRKLEVBQUUsV0FFRTZGLFNBQVNDLFNBQVNDLFFBQVFDLFVBQVksU0FBVUMsR0FDNUMsSUFBSUMsRUFBTyxJQUFJVixLQUFLUyxHQUNoQkUsRUFBUUQsRUFBS1QsVUFFYkYsSUFETSxJQUFLQyxNQUFRQyxVQUNGVSxHQUFPLElBQzVCLE9BQUdaLEVBQVUsR0FDRixLQUVPLEdBQVZBLEdBQWdCQSxFQUFVLE1BQzVCYSxRQUFVL0IsU0FBU2tCLEVBQVUsSUFDdkJhLFFBQVEsT0FFRCxLQUFWYixHQUFtQkEsRUFBVSxPQUNsQ2MsTUFBUWhDLFNBQVNrQixFQUFVLE1BQ3BCYyxNQUFNLE9BR0MsTUFBVmQsR0FBc0JBLEVBQVcsUUFFckNlLEtBQU9qQyxTQUFTa0IsRUFBVSxPQUNuQmUsS0FBSyxNQUVESixFQUFLSyxjQUtKLElBSkFMLEVBQUtNLFdBSUssSUFIWk4sRUFBS08sU0FHZSxJQUZuQlAsRUFBS1EsV0FFdUIsSUFEN0JSLEVBQUtTIiwiZmlsZSI6ImZyb250X2Jhc2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8g5pi+56S655So5oi35pu05aSa5L+h5oGv5Luj56CBXHJcblxyXG5mdW5jdGlvbiBGcm9udEJhc2UoKSB7XHJcblxyXG59XHJcbkZyb250QmFzZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5MaXN0ZW5Vc2VyQm94KCk7XHJcbn07XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLkxpc3RlblVzZXJCb3ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIGF1dGhCb3g9ICQoJy5hdXRoLWJveCcpO1xyXG4gIHZhciB1c2VyTW9yZUJveCA9ICQoJy51c2VyLW1vcmUtYm94Jyk7XHJcbiAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHVzZXJNb3JlQm94LnNob3coKTtcclxuICB9LGZ1bmN0aW9uICgpIHtcclxuICAgICAgdXNlck1vcmVCb3guaGlkZSgpO1xyXG4gIH0pXHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgdmFyIGZyb250QmFzZSA9IG5ldyBGcm9udEJhc2UoKTtcclxuICAgZnJvbnRCYXNlLnJ1bigpO1xyXG59KTtcclxuXHJcbi8vICMg55So5oi355m75b2V5rOo5YaM55qEanPku6PnoIFcclxuXHJcblxyXG5cclxuZnVuY3Rpb24gQXV0aCgpIHtcclxuICAgIHRoaXMuc2Nyb2xsV3JhcHBlciA9ICQoJy5zY3JvbGwtd3JhcHBlcicpO1xyXG4gICAgdGhpcy5tYXNrV3JhcHBlciA9ICQoJy5tYXNrLXdyYXBwZXInKTtcclxuICAgIHRoaXMuc21zQ2FwdGhhQnRuID0gJCgnI3Ntcy1jYXB0Y2hhJyk7XHJcbn1cclxuXHJcblxyXG5BdXRoLnByb3RvdHlwZS5TaG93RXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLnNob3coKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLkhpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIuaGlkZSgpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuTGlzdGVuQnRuQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc2lnbmluQnRuID0gJCgnLnNpZ25pbi1idG4nKTtcclxuICAgIHZhciBzaWdudXBCdG4gPSAkKCcuc2lnbnVwLWJ0bicpO1xyXG4gICAgdmFyIGNsb3NlQnRuID0gJCgnLmNsb3NlLWJ0bicpO1xyXG4gICAgc2lnbmluQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLlNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoeydsZWZ0JzowfSlcclxuICAgIH0pO1xyXG4gICAgc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLlNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoeydsZWZ0JzonLTQwMHB4J30pXHJcbiAgICB9KTtcclxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgIHNlbGYuSGlkZUV2ZW50KClcclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy8gIyDnmbvlvZVcclxuQXV0aC5wcm90b3R5cGUuTGlzdGVuU2lnbmluQnRuQ2xpY2sgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJCgnLnNpZ25pbi1ncm91cCcpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbmluR3JvdXAuZmluZCgnLnN1Ym1pdC1idG4nKTtcclxuXHJcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbiAgICAgICByZW1lbWJlciA9cmVtZW1iZXJJbnB1dC5wcm9wKCdjaGVja2VkJyk7XHJcbiAgICAgICBpZighdGVsZXBob25lIHx8ICFwYXNzd29yZCl7XHJcbiAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0luZm8oJ+ivt+i+k+WFpeWujOaVtOeahOi0puWPt+S/oeaBr++8gScpXHJcbiAgICAgICB9XHJcbiAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICd1cmwnOicvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOnRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzpwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzpyZW1lbWJlcj8xOjBcclxuICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICBzZWxmLkhpZGVFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXHJcbiAgICAgICAgICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgICAgICAgIC8vIOagueaNrumcgOaxgu+8jGZvcm1z5Lit5bey57uP5bCGZ2V0X2Vycm9yc+eahOi/lOWbnuWAvOWkhOeQhuS4uuWtl+WFuOagvOW8j1xyXG4gICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VPYmplY3QgPSByZXN1bHRbJ21lc3NhZ2UnXTtcclxuICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBtZXNzYWdlT2JqZWN0ID09ICdzdHJpbmcnfHwgbWVzc2FnZU9iamVjdC5jb25zdHJ1Y3RvciA9PSBTdHJpbmcgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IobWVzc2FnZU9iamVjdClcclxuICAgICAgICAgICAgICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAvLyB7J3VzZXJuYW1lJzpbJ3h4eHh4eHh4eHh4eHh4eCcsJ3h4eCddLCd0ZWxlcGhvbmUnOlsneHh4eHh4eCcsJ3h4eHh4eCddfVxyXG4gICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIga2V5IGluIG1lc3NhZ2VPYmplY3Qpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSBtZXNzYWdlT2JqZWN0W2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihtZXNzYWdlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgJ2ZhaWwnOmZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IoZXJyb3IpXHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbn07XHJcbi8vIOazqOWGjFxyXG5BdXRoLnByb3RvdHlwZS5MaXN0ZW5zaWdudXBFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2lnbnVwR3JvdXAgPSAkKCcuc2lnbnVwLWdyb3VwJyk7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICB2YXIgc21zY2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Ntc19jYXB0Y2hhJ11cIik7XHJcbiAgICB2YXIgaW1nY2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J2ltZ19jYXB0Y2hhJ11cIik7XHJcbiAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd1c2VybmFtZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkMUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkMklucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMiddXCIpO1xyXG4gICAgdmFyIHNpZ251cEJ0biA9IHNpZ251cEdyb3VwLmZpbmQoJy5zdWJtaXQtYnRuJyk7XHJcblxyXG4gICAgc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBzbXNfY2FwdGNoYSA9IHNtc2NhcHRjaGFJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdjYXB0Y2hhSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZDJJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWUgPSB1c2VybmFtZUlucHV0LnZhbCgpO1xyXG5cclxuICAgICAgICBpZighdGVsZXBob25lKXtcclxuICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKCfor7fovpPlhaXmiYvmnLrlj7cnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgaWYoIXVzZXJuYW1lKXtcclxuICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKCfor7fovpPlhaXnlKjmiLflkI0nKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgaWYoIXBhc3N3b3JkMSl7XHJcbiAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcign6K+36L6T5YWl5a+G56CBJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgIGlmKCFwYXNzd29yZDIpe1xyXG4gICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IoJ+ivt+WGjeasoeehruiupOWvhueggScpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgICBpZighc21zX2NhcHRjaGEpe1xyXG4gICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IoJ+ivt+i+k+WFpemqjOivgeeggScpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaW1nX2NhcHRjaGEpIHtcclxuICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKCfor7fovpPlhaXpqozor4HnoIEnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzonL2FjY291bnQvc2lnbnVwLycsXHJcbiAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzp0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAndXNlcm5hbWUnOnVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMSc6cGFzc3dvcmQxLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMic6cGFzc3dvcmQyLFxyXG4gICAgICAgICAgICAgICAgJ2ltZ19jYXB0Y2hhJzppbWdfY2FwdGNoYSxcclxuICAgICAgICAgICAgICAgICdzbXNfY2FwdGNoYSc6c21zX2NhcHRjaGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PSAyMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxyXG4gICAgICAgICAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOagueaNrumcgOaxgu+8jGZvcm1z5Lit5bey57uP5bCGZ2V0X2Vycm9yc+eahOi/lOWbnuWAvOWkhOeQhuS4uuWtl+WFuOagvOW8j1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlT2JqZWN0ID0gcmVzdWx0WydtZXNzYWdlJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlT2JqZWN0ID09ICdzdHJpbmcnIHx8IG1lc3NhZ2VPYmplY3QuY29uc3RydWN0b3IgPT0gU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihtZXNzYWdlT2JqZWN0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHsndXNlcm5hbWUnOlsneHh4eHh4eHh4eHh4eHh4JywneHh4J10sJ3RlbGVwaG9uZSc6Wyd4eHh4eHh4JywneHh4eHh4J119XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gbWVzc2FnZU9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gbWVzc2FnZU9iamVjdFtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBtZXNzYWdlc1swXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihtZXNzYWdlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6ZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93RXJyb3IoZXJyb3IpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufTtcclxuQXV0aC5wcm90b3R5cGUuU3dpdGNoID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzd2l0Y2hCdG4gPSAkKCcuc3dpdGNoJyk7XHJcbiAgICBzd2l0Y2hCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjdXJyZW50TGVmdCA9IHNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoXCJsZWZ0XCIpO1xyXG4gICAgICAgIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQoY3VycmVudExlZnQpO1xyXG4gICAgICAgIGlmIChjdXJyZW50TGVmdCA8IDApIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOiAnMCd9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiLTQwMHB4XCJ9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuLy8g5Zu+5b2i6aqM6K+B56CB54K55Ye75Y+Y5o2i5LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLkxpc3RlbmltZ0NhcHRjaGEgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIGltZ0NhcHRjaGEgPSAkKCcjY2FwdGNoYS1pbWcnKTtcclxuICAgIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgaW1nQ2FwdGNoYS5hdHRyKCdzcmMnLCcvYWNjb3VudC9pbWdfY2FwdGNoYS8nKyc/PXJhbmRvbScrTWF0aC5yYW5kb20oKSlcclxuICAgIH0pO1xyXG59O1xyXG4vLyAg6aqM6K+B56CB5oiQ5Yqf5Y+R6YCB5LqL5Lu2XHJcbkF1dGgucHJvdG90eXBlLkxpc3RlbnNtc1N1Y2Nlc3NTZW5kID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKCflj5HpgIHmiJDlip/vvIzor7fms6jmhI/mn6XmlLYnKTtcclxuICAgIHNlbGYuc21zQ2FwdGhhQnRuLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgdmFyIGNvdW50ID0gMTA7XHJcbiAgICBzZWxmLnNtc0NhcHRoYUJ0bi51bmJpbmQoJ2NsaWNrJyk7XHJcbiAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zbXNDYXB0aGFCdG4udGV4dChjb3VudCArICdzJyk7XHJcbiAgICAgICAgY291bnQgLT0gMTtcclxuICAgICAgICBpZiAoY291bnQgPD0gMCkge1xyXG4gICAgICAgICAgICBzZWxmLnNtc0NhcHRoYUJ0bi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGhhQnRuLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xyXG4gICAgICAgICAgICBzZWxmLkxpc3RlbnNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIDEwMDApXHJcbn07XHJcbi8vIOefreS/oemqjOivgeeggeWPkemAgeS6i+S7tlxyXG5BdXRoLnByb3RvdHlwZS5MaXN0ZW5zbXNDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ251cEdyb3VwID0gJCgnLnNpZ251cC1ncm91cCcpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG5cclxuICAgIHNlbGYuc21zQ2FwdGhhQnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIC8v6I635Y+W5pe26Ze05oizXHJcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IChuZXcgRGF0ZSkuZ2V0VGltZSgpO1xyXG4gICAgICAgIC8vIOeUn+aIkOS4gOS4qnNpZ24gLOeUqOS6jumqjOivge+8gVxyXG4gICAgICAgIHZhciBzaWduID0gbWQ1KHRlbGVwaG9uZSArIHRpbWVzdGFtcCArICdkYWdmZHYhQCQlJCNeZ2hnZGFmZHZzYWZhJEAkIycpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRpbWVzdGFtcCk7XHJcbiAgICAgICAgaWYgKCEoL14xWzM1Nzg5XVxcZHs5fSQvLnRlc3QodGVsZXBob25lKSkpIHtcclxuICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKCfor7fovpPlhaXmraPnoa7nmoTmiYvmnLrlj7fvvIEnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L3Ntc19jYXB0Y2hhLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICd0aW1lc3RhbXAnOnRpbWVzdGFtcCxcclxuICAgICAgICAgICAgICAgICdzaWduJzpzaWduXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuTGlzdGVuc21zU3VjY2Vzc1NlbmQoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKHJlc3VsdFsnbWVzc2FnZSddKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOiBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcihlcnJvcilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG4vLyDlhaXlj6Plh73mlbBcclxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5MaXN0ZW5CdG5DbGljaygpO1xyXG4gICAgdGhpcy5Td2l0Y2goKTtcclxuICAgIHRoaXMuTGlzdGVuU2lnbmluQnRuQ2xpY2soKTtcclxuICAgIHRoaXMuTGlzdGVuaW1nQ2FwdGNoYSgpO1xyXG4gICAgdGhpcy5MaXN0ZW5zbXNDYXB0Y2hhRXZlbnQoKTsgLy/nn63kv6Hpqozor4HnoIFcclxuICAgIHRoaXMuTGlzdGVuc2lnbnVwRXZlbnQoKTsvLyDnlKjmiLfms6jlhoxcclxufTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICAgYXV0aC5ydW4oKTtcclxufSk7XHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgLy8gYXJ0LXRlbXBsYXRl5qih5p2/6L+H5ruk5ZmoXHJcbiAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVzaW5jZSA9IGZ1bmN0aW9uICh2YWx1ZURhdGUpIHtcclxuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKHZhbHVlRGF0ZSk7XHJcbiAgICAgICAgdmFyIGRhdGVzID0gZGF0ZS5nZXRUaW1lKCk7XHJcbiAgICAgICAgdmFyIG5vdyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IChub3ctZGF0ZXMpLzEwMDA7XHJcbiAgICAgICAgaWYodGltZXN0YW1wPDYwKXtcclxuICAgICAgICAgICAgcmV0dXJuICfliJrliJonO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcD42MCAmJiB0aW1lc3RhbXA8NjAqNjApe1xyXG4gICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAvNjApO1xyXG4gICAgICAgICAgICByZXR1cm4gIG1pbnV0ZXMrJ+WIhumSn+WJjSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRpbWVzdGFtcD42MCo2MCAmJiB0aW1lc3RhbXA8NjAqNjAqMjQpIHtcclxuICAgICAgICAgICAgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAvKDYwKjYwKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBob3Vycysn5bCP5pe25YmNJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGVsc2UgaWYodGltZXN0YW1wPjYwKjYwKjI0ICYmIHRpbWVzdGFtcCA8NjAqNjAqMjQqMzApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBkYXlzID0gcGFyc2VJbnQodGltZXN0YW1wLyg2MCo2MCoyNCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGF5cysn5aSp5YmNJztcclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XHJcbiAgICAgICAgICAgIHZhciBkYXkgPSBkYXRlLmdldERheSgpO1xyXG4gICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgdmFyIG1pbiA9IGRhdGUuZ2V0TWludXRlcygpO1xyXG4gICAgICAgICAgICByZXR1cm4geWVhcisnLycrbW9udGgrJy8nK2RheSsnLycraG91cisnLycrbWluO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbn0pO1xyXG4vLyAjIOWbvuW9oumqjOivgeeggeWIt+aWsFxyXG4vLyAkKGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICQoJyNjYXB0Y2hhLWltZycpLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4vLyAgICAgICAgIHZhciBzZWxmID0gJCh0aGlzKTtcclxuLy8gICAgICAgICB2YXIgc3JjID0gc2VsZi5hdHRyKCdzcmMnKTtcclxuLy8gICAgICAgICB2YXIgbmV3c3JjID0gemxwYXJhbS5zZXRQYXJhbShzcmMsJ3h4JyxNYXRoLnJhbmRvbSgpKTtcclxuLy8gICAgICAgICBzZWxmLmF0dHIoJ3NyYycsbmV3c3JjKTtcclxuLy8gICAgIH0pXHJcbi8vIH0pO1xyXG4iXX0=
